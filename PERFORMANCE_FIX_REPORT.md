# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üö® –ü—Ä–æ–±–ª–µ–º—ã

### 1. –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ `/me`
- Sidebar –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–µ–ª–∞–ª –∑–∞–ø—Ä–æ—Å `/api/auth/me` –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `pathname`
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ –æ–∫–Ω–∞ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏
- –†–µ–∑—É–ª—å—Ç–∞—Ç: —Å–æ—Ç–Ω–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É

### 2. 500 –æ—à–∏–±–∫–∞ –Ω–∞ IIKO endpoint
- Endpoint `/api/iiko/stores/consumption` –≤–æ–∑–≤—Ä–∞—â–∞–ª 500 Internal Server Error
- –ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ API –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

## üîß –†–µ—à–µ–Ω–∏—è

### 1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è sidebar –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

**–ë—ã–ª–æ:**
```javascript
useEffect(() => {
  fetchMe()
}, [pathname]) // –ó–∞–ø—Ä–æ—Å –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—É—Ç–∏

useEffect(() => {
  const onFocus = () => fetchMe()
  const onVisibility = () => { if (!document.hidden) fetchMe() }
  // –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ/–≤–∏–¥–∏–º–æ—Å—Ç–∏
}, [])
```

**–°—Ç–∞–ª–æ:**
```javascript
useEffect(() => {
  // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
  fetchMe()
}, []) // –£–±—Ä–∞–ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç pathname

useEffect(() => {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–∏ —Ñ–æ–∫—É—Å–∞, 
  // –Ω–æ –Ω–µ —á–∞—â–µ —á–µ–º —Ä–∞–∑ –≤ 30 —Å–µ–∫—É–Ω–¥
  let lastCheck = 0
  const onFocus = () => {
    const now = Date.now()
    if (now - lastCheck > 30000) {
      fetchMe()
      lastCheck = now
    }
  }
  // –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è visibility
}, [])
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–≤—Ç–æ—Ä–Ω–æ –≤—ã–ø–æ–ª–Ω–∏–ª–∏ `prisma db push --accept-data-loss`
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–ª–∏ API –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- –£–±–µ–¥–∏–ª–∏—Å—å, —á—Ç–æ –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- ‚ùå **–ë—ã–ª–æ:** –°–æ—Ç–Ω–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ `/me` –≤ —Å–µ–∫—É–Ω–¥—É
- ‚úÖ **–°—Ç–∞–ª–æ:** –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ + —Ä–µ–¥–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–º–∞–∫—Å–∏–º—É–º —Ä–∞–∑ –≤ 30 —Å–µ–∫)

### API —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:
- ‚ùå **–ë—ã–ª–æ:** 500 –æ—à–∏–±–∫–∏ –Ω–∞ IIKO endpoints
- ‚úÖ **–°—Ç–∞–ª–æ:** –í—Å–µ endpoints —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç:
- ‚ùå **–ë—ã–ª–æ:** –ó–∞–º–µ–¥–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏–∑-–∑–∞ –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ **–°—Ç–∞–ª–æ:** –ë—ã—Å—Ç—Ä–∞—è –∏ –æ—Ç–∑—ã–≤—á–∏–≤–∞—è —Ä–∞–±–æ—Ç–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Sidebar –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã: 1 –∑–∞–ø—Ä–æ—Å `/me`
- ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏: 0 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –í–æ–∑–≤—Ä–∞—Ç —Ñ–æ–∫—É—Å–∞: –∑–∞–ø—Ä–æ—Å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø—Ä–æ—à–ª–æ >30 —Å–µ–∫

### IIKO endpoints:
- ‚úÖ `/api/iiko/stores/consumption` - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ API endpoints —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–µ—à–µ–Ω—ã!**

- üöÄ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–µ–Ω–∞ –∑–∞ —Å—á–µ—Ç —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- üîß **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** API —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –±–µ–∑ –æ—à–∏–±–æ–∫
- üë§ **UX:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –±—ã—Å—Ç—Ä—ã–π –∏ –æ—Ç–∑—ã–≤—á–∏–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- üì± **–†–µ—Å—É—Ä—Å—ã:** –°–Ω–∏–∂–µ–Ω–∞ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ —Å–µ—Ç—å

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –∞–∫—Ç–∏–≤–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ—Ç–∑—ã–≤—á–∏–≤—ã–π –∏ –±—ã—Å—Ç—Ä—ã–π
- –ù–µ—Ç –∏–∑–±—ã—Ç–æ—á–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤—Å–µ—Ö API endpoints

---

**–í—Ä–µ–º—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** ~10 –º–∏–Ω—É—Ç  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û  
**–î–∞—Ç–∞:** $(date)
