# üéâ Cafe Finance Lite v3 - –†–ï–õ–ò–ó

**–î–∞—Ç–∞ –≤—ã–ø—É—Å–∫–∞:** 01 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready  
**–í–µ—Ä—Å–∏—è:** 3.0.0

---

## üì¶ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### ‚úÖ 19 –∏–∑ 20 –∑–∞–¥–∞—á MVP –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (95%)

**10 –∫–æ–º–º–∏—Ç–æ–≤** | **27 —Ñ–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ** | **+4,504 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞**

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (10 –Ω–æ–≤—ã—Ö):

1. **Channel** - –∫–∞–Ω–∞–ª—ã –ø—Ä–æ–¥–∞–∂ (Dine-in, Pickup, Grab, Foodpanda)
2. **TenderType** - —Å–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã (–ù–∞–ª–∏—á–Ω—ã–µ, –ö–∞—Ä—Ç–∞, QR, –ë–æ–Ω—É—Å—ã)
3. **Shift** - —Å–º–µ–Ω—ã —Å –¥–∞—Ç–∞–º–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è
4. **ShiftSale** - –ø—Ä–æ–¥–∞–∂–∏ (–∫–∞–Ω–∞–ª √ó —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã)
5. **ExpenseDoc** - –¥–æ–∫—É–º–µ–Ω—Ç—ã —Ä–∞—Å—Ö–æ–¥–æ–≤ —Å –¥–æ–ª–≥–∞–º–∏
6. **Payment** - –ø–ª–∞—Ç–µ–∂–∏
7. **PaymentAllocation** - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π
8. **CashTx** - –¥–µ–Ω–µ–∂–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
9. **Category.kind** - —Ç–∏–ø —Ä–∞—Å—Ö–æ–¥–∞ (COGS/OPEX/CAPEX/TAX/FEE)

### API Endpoints (15+ –Ω–æ–≤—ã—Ö):

**–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏:**
- `GET/POST/PATCH/DELETE /api/channels`
- `GET/POST/PATCH/DELETE /api/tender-types`

**–û–ø–µ—Ä–∞—Ü–∏–∏:**
- `GET/POST /api/shifts`
- `POST /api/shifts/:id/close`
- `GET/POST/PATCH/DELETE /api/expense-docs`
- `GET/POST/DELETE /api/payments`

**–û—Ç—á—ë—Ç—ã:**
- `GET /api/reports/pnl` - —É–ª—É—á—à–µ–Ω–Ω—ã–π P&L
- `GET /api/reports/aging` - –¥–æ–ª–≥–∏ –ø–æ —Å—Ä–æ–∫–∞–º
- `GET /api/reports/shift-summary` - –¥–Ω–µ–≤–Ω–∞—è —Å–≤–æ–¥–∫–∞
- `GET /api/reports/shifts-reconciliation` - —Å–≤–µ—Ä–∫–∞ iiko

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- `POST /api/iiko/import/shifts` - –∏–º–ø–æ—Ä—Ç —Å–º–µ–Ω –∏–∑ iiko

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (5 –Ω–æ–≤—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤):

1. **/shifts** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–º–µ–Ω–∞–º–∏
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç –∏–∑ iiko
   - –ò—Å—Ç–æ—Ä–∏—è —Å–º–µ–Ω —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π
   - –¢–∞–±–ª–∏—Ü–∞ —Å–≤–µ—Ä–∫–∏ —á–µ–∫–æ–≤ vs —Å–º–µ–Ω

2. **/finance/expense-docs** - –¥–æ–∫—É–º–µ–Ω—Ç—ã —Ä–∞—Å—Ö–æ–¥–æ–≤
   - –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - –°—Ç–∞—Ç—É—Å—ã: draft/unpaid/partial/paid/void
   - –§–∏–ª—å—Ç—Ä—ã, –≤–æ–∑—Ä–∞—Å—Ç –¥–æ–ª–≥–∞

3. **/finance/payments** - –ø–ª–∞—Ç–µ–∂–∏
   - –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á—ë—Ç —Å—É–º–º
   - –ò—Å—Ç–æ—Ä–∏—è —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π

4. **/finance/reports/aging** - –∞–Ω–∞–ª–∏–∑ –¥–æ–ª–≥–æ–≤
   - Bucket'—ã: 0-30/31-60/61-90/90+ –¥–Ω–µ–π
   - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º
   - –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è

5. **/finance/reports/pnl** - —É–ª—É—á—à–µ–Ω–Ω—ã–π P&L
   - –í—ã—Ä—É—á–∫–∞ ‚Üí COGS ‚Üí –í–∞–ª–æ–≤–∞—è ‚Üí OPEX ‚Üí –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è ‚Üí –ß–∏—Å—Ç–∞—è
   - –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –∫–∞–Ω–∞–ª–∞–º –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
   - CAPEX –æ—Ç–¥–µ–ª—å–Ω–æ

---

## üîÑ –ö–ª—é—á–µ–≤–∞—è —Ñ–∏—á–∞: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç –∏–∑ iiko

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ß–µ–∫–∏ —É–∂–µ –≤ –ë–î** (IikoReceipt) —á–µ—Ä–µ–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∏–º–ø–æ—Ä—Ç
2. **–°–∫—Ä–∏–ø—Ç –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç** —á–µ–∫–∏ –ø–æ –¥–∞—Ç–∞–º
3. **–°–æ–∑–¥–∞—ë—Ç Shift** —Å –¥–∞—Ç–∞–º–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è
4. **–ê–≥—Ä–µ–≥–∏—Ä—É–µ—Ç ShiftSale** –ø–æ –º–∞—Ç—Ä–∏—Ü–µ:
   - –ö–∞–Ω–∞–ª (orderType + deliveryServiceType)
   - –°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã (payTypesJson)
   - –°—É–º–º—ã (net, –≤–æ–∑–≤—Ä–∞—Ç—ã)

### –ú–∞–ø–ø–∏–Ω–≥ iiko ‚Üí Finance:

**–ö–∞–Ω–∞–ª—ã:**
- `orderType: "–û–±—ã—á–Ω—ã–π –∑–∞–∫–∞–∑"` ‚Üí **Dine-in**
- `deliveryServiceType: "PICKUP"` ‚Üí **Pickup**
- `deliveryServiceType: "COURIER"` ‚Üí **Grab**

**–°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã:**
- `["–ù–∞–ª–∏—á–Ω—ã–µ"]` ‚Üí **–ù–∞–ª–∏—á–Ω—ã–µ**
- `["–ò–ü –°–±–µ—Ä"]`, `["–û–û–û –°–±–µ—Ä"]` ‚Üí **–ö–∞—Ä—Ç–∞**
- `["–±–æ–Ω—É—Å"]` ‚Üí **–ë–æ–Ω—É—Å—ã**

### –†–µ–∑—É–ª—å—Ç–∞—Ç –∏–º–ø–æ—Ä—Ç–∞ (–ø—Ä–∏–º–µ—Ä):

**28-30 —Å–µ–Ω—Ç—è–±—Ä—è:**
- ‚úÖ 3 —Å–º–µ–Ω—ã —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ 18 –ø—Ä–æ–¥–∞–∂ (channel √ó tender)
- ‚úÖ 251 —á–µ–∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω
- ‚úÖ –°—É–º–º—ã —Å–≤–µ—Ä–µ–Ω—ã: 100% —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ

---

## üìä –î–≤–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏

### operation_date vs posting_period

**–ü—Ä–∏–º–µ—Ä: –ê—Ä–µ–Ω–¥–∞ –∑–∞ —è–Ω–≤–∞—Ä—å**
- –°—á—ë—Ç –ø–æ–ª—É—á–µ–Ω: **05.02.2025** (operation_date)
- –û—Ç–Ω–æ—Å–∏—Ç—Å—è –∫: **01.2025** (posting_period)
- –û–ø–ª–∞—á–µ–Ω: **10.02.2025**

**–≠—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ P&L —è–Ω–≤–∞—Ä—è: —Ä–∞—Å—Ö–æ–¥ 50 000 ‚ÇΩ (–ø–æ posting_period)
- ‚úÖ Cash Flow —Ñ–µ–≤—Ä–∞–ª—è: –≤—ã–ø–ª–∞—Ç–∞ 50 000 ‚ÇΩ (–ø–æ –¥–∞—Ç–µ –æ–ø–ª–∞—Ç—ã)
- ‚úÖ Aging –Ω–∞ 31.01: –¥–æ–ª–≥ 50 000 ‚ÇΩ
- ‚úÖ Aging –Ω–∞ 28.02: –¥–æ–ª–≥ 0 ‚ÇΩ

---

## üìà –û—Ç—á—ë—Ç P&L (–Ω–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)

```
–í–´–†–£–ß–ö–ê (–Ω–µ—Ç—Ç–æ –∏–∑ —Å–º–µ–Ω)                    900 000 ‚ÇΩ
‚îú‚îÄ Dine-in                                 500 000 ‚ÇΩ
‚îú‚îÄ Pickup                                  200 000 ‚ÇΩ
‚îú‚îÄ Grab                                    150 000 ‚ÇΩ
‚îî‚îÄ Foodpanda                                50 000 ‚ÇΩ

–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (COGS)                      ‚àí360 000 ‚ÇΩ
‚îú‚îÄ –ú—è—Å–æ –∏ —Ä—ã–±–∞                            ‚àí150 000 ‚ÇΩ
‚îú‚îÄ –û–≤–æ—â–∏                                   ‚àí80 000 ‚ÇΩ
‚îú‚îÄ –ú–æ–ª–æ—á–∫–∞                                 ‚àí70 000 ‚ÇΩ
‚îî‚îÄ –£–ø–∞–∫–æ–≤–∫–∞                                ‚àí60 000 ‚ÇΩ

= –í–ê–õ–û–í–ê–Ø –ü–†–ò–ë–´–õ–¨                          540 000 ‚ÇΩ

–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã (OPEX)               ‚àí320 000 ‚ÇΩ
‚îú‚îÄ –ê—Ä–µ–Ω–¥–∞                                  ‚àí50 000 ‚ÇΩ
‚îú‚îÄ –ó–∞—Ä–ø–ª–∞—Ç–∞                               ‚àí200 000 ‚ÇΩ
‚îú‚îÄ –ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ                            ‚àí40 000 ‚ÇΩ
‚îî‚îÄ –ü—Ä–æ—á–µ–µ                                  ‚àí30 000 ‚ÇΩ

= –û–ü–ï–†–ê–¶–ò–û–ù–ù–ê–Ø –ü–†–ò–ë–´–õ–¨                     220 000 ‚ÇΩ

–ö–æ–º–∏—Å—Å–∏–∏                                   ‚àí10 000 ‚ÇΩ

= –ß–ò–°–¢–ê–Ø –ü–†–ò–ë–´–õ–¨                           210 000 ‚ÇΩ

---
CAPEX (–Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ P&L):                 200 000 ‚ÇΩ
```

---

## üîê –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

### –£—á—ë—Ç –¥–æ–ª–≥–æ–≤:
- ‚úÖ ExpenseDoc —Å–æ —Å—Ç–∞—Ç—É—Å–∞–º–∏ (draft ‚Üí unpaid ‚Üí partial ‚Üí paid)
- ‚úÖ –ß–∞—Å—Ç–∏—á–Ω–∞—è –æ–ø–ª–∞—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Å—á—ë—Ç paid_amount
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–º–µ–Ω–∞ —Å—Ç–∞—Ç—É—Å–æ–≤

### –í–∞–ª–∏–¥–∞—Ü–∏–∏:
- ‚úÖ posting_period –≤—Å–µ–≥–¥–∞ = 1-–µ —á–∏—Å–ª–æ –º–µ—Å—è—Ü–∞
- ‚úÖ –°—É–º–º–∞ allocations ‚â§ —Å—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–∞
- ‚úÖ allocation.amount ‚â§ –æ—Å—Ç–∞—Ç–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- ‚úÖ paid_amount –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∏–∑ allocations (–Ω–µ –≤–≤–æ–¥–∏—Ç—Å—è)

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:
- ‚úÖ CashTx —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ –ø–ª–∞—Ç–µ–∂–∞—Ö
- ‚úÖ –°—Ç–∞—Ç—É—Å—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ
- ‚úÖ –ü–µ—Ä–µ—Å—á—ë—Ç –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ –ø–ª–∞—Ç–µ–∂–∞
- ‚úÖ –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ activity –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

---

## üöÄ –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã

### 1. –ü–µ—Ä–≤–∏—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:

```bash
# Backend
cd server
npm install
npx prisma generate
npx tsx scripts/seed-finance-v3.ts

# Frontend
cd client
npm install
```

### 2. –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö:

```bash
# –ò–º–ø–æ—Ä—Ç —á–µ–∫–æ–≤ iiko (–µ—Å–ª–∏ –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã)
cd server
npx tsx scripts/import-iiko-receipts.ts

# –ò–º–ø–æ—Ä—Ç —Å–º–µ–Ω –∏–∑ —á–µ–∫–æ–≤
npx tsx scripts/import-shifts-from-iiko.ts "2025-09-01" "2025-10-01"
```

### 3. –ó–∞–ø—É—Å–∫:

```bash
# Backend (—Ç–µ—Ä–º–∏–Ω–∞–ª 1)
cd server && npm run dev  # localhost:4000

# Frontend (—Ç–µ—Ä–º–∏–Ω–∞–ª 2)
cd client && npm run dev  # localhost:3000
```

---

## üì± –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞:

1. **–£—Ç—Ä–æ–º:** –ó–∞–≥—Ä—É–∑–∏—Ç—å —á–µ–∫–∏ iiko (–µ—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
2. **–ü–æ—Å–ª–µ —Å–º–µ–Ω—ã:** –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–º–µ–Ω—ã —á–µ—Ä–µ–∑ `/shifts` ‚Üí "–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑ iiko"
3. **–ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å—á—ë—Ç–∞:** –°–æ–∑–¥–∞—Ç—å ExpenseDoc —á–µ—Ä–µ–∑ `/finance/expense-docs`
4. **–ü—Ä–∏ –æ–ø–ª–∞—Ç–µ:** –ü—Ä–æ–≤–µ—Å—Ç–∏ –ø–ª–∞—Ç—ë–∂ —á–µ—Ä–µ–∑ `/finance/payments`

### –û—Ç—á—ë—Ç—ã (–∫–æ–Ω–µ—Ü –º–µ—Å—è—Ü–∞):

1. **P&L:** `/finance/reports/pnl` - –ø—Ä–∏–±—ã–ª–∏ –∏ —É–±—ã—Ç–∫–∏
2. **Aging:** `/finance/reports/aging` - –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ–ª–≥–æ–≤
3. **Cash Flow:** `/finance/reports/cashflow` - –¥–≤–∏–∂–µ–Ω–∏–µ –¥–µ–Ω–µ–≥
4. **–ë–∞–ª–∞–Ω—Å—ã:** `/finance/balances` - –æ—Å—Ç–∞—Ç–∫–∏ –ø–æ —Å—á–µ—Ç–∞–º

---

## ‚ú® –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ v3

### vs v2 (Transaction-based):

| v2 | v3 |
|---|---|
| Transaction = –≤—Å—ë –≤ –æ–¥–Ω–æ–º | ExpenseDoc + Payment + CashTx |
| –ù–µ—Ç —É—á—ë—Ç–∞ –¥–æ–ª–≥–æ–≤ | –ü–æ–ª–Ω—ã–π —É—á—ë—Ç —Å —Å—Ç–∞—Ç—É—Å–∞–º–∏ |
| –û–¥–Ω–∞ –¥–∞—Ç–∞ (paymentDate) | –î–≤–µ –¥–∞—Ç—ã (operation_date, posting_period) |
| –ü—Ä–æ—Å—Ç–æ–π P&L | –ü–æ–ª–Ω—ã–π P&L (COGS ‚Üí –í–∞–ª–æ–≤–∞—è ‚Üí –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è) |
| –ù–µ—Ç —Å–º–µ–Ω | –°–º–µ–Ω—ã –∏–∑ iiko –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| –†—É—á–Ω–æ–π –≤–≤–æ–¥ | –ê–≤—Ç–æ–∏–º–ø–æ—Ä—Ç –∏–∑ iiko |

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- ü§ñ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:** –∏–º–ø–æ—Ä—Ç —Å–º–µ–Ω –∏–∑ iiko –∑–∞ 30 —Å–µ–∫—É–Ω–¥
- üí∞ **–î–æ–ª–≥–∏:** –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤
- üìä **P&L:** –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –≤–∞–ª–æ–≤–æ–π –ø—Ä–∏–±—ã–ª—å—é
- üìÖ **–î–≤–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è:** —Ñ–∞–∫—Ç –∏ —É—á—ë—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥
- üéØ **–¢–æ—á–Ω–æ—Å—Ç—å:** –¥–∞–Ω–Ω—ã–µ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ iiko —á–µ–∫–æ–≤
- ‚úÖ **–°–≤–µ—Ä–∫–∞:** –∫–æ–Ω—Ç—Ä–æ–ª—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∏–º–ø–æ—Ä—Ç–∞

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

1. **finance-v3-summary.md** - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. **finance-implementation-checklist.md** - —á–µ–∫-–ª–∏—Å—Ç (19/20 ‚úÖ)
3. **iiko-shifts-integration.md** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å iiko
4. **accaunting.md** - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ
5. **FINANCE_V3_RELEASE.md** - —ç—Ç–æ—Ç —Ñ–∞–π–ª

---

## üéØ –ß—Ç–æ –ù–ï –≤–æ—à–ª–æ –≤ MVP (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

1. ‚è≥ **Cash Flow —É–ª—É—á—à–µ–Ω–Ω—ã–π** - —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CashTx
2. ‚è≥ **–°–≤–µ—Ä–∫–∞ –±–∞–Ω–∫–∞ UI** - –º–æ–¥–µ–ª–∏ –≥–æ—Ç–æ–≤—ã, –Ω—É–∂–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
3. ‚è≥ **–ó–∞–∫—Ä—ã—Ç–∏–µ –ø–µ—Ä–∏–æ–¥–∞** - lock posting_period
4. ‚è≥ **–ê–≥—Ä–µ–≥–∞—Ç–æ—Ä—ã** - PayoutRegister (–ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é –∏—Å–∫–ª—é—á–µ–Ω–æ)

**–≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã!**

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:

**–ò–º–ø–æ—Ä—Ç —Å–º–µ–Ω:**
- ‚úì 251 —á–µ–∫ –∑–∞ 3 –¥–Ω—è
- ‚úì 3 —Å–º–µ–Ω—ã —Å–æ–∑–¥–∞–Ω—ã
- ‚úì 18 –ø—Ä–æ–¥–∞–∂ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω—ã
- ‚úì –°—É–º–º—ã —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å iiko

**–£—á—ë—Ç –¥–æ–ª–≥–æ–≤:**
- ‚úì –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Ä–∞—Å—Ö–æ–¥–∞
- ‚úì –ß–∞—Å—Ç–∏—á–Ω–∞—è –æ–ø–ª–∞—Ç–∞
- ‚úì –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
- ‚úì –ê–≤—Ç–æ–ø–µ—Ä–µ—Å—á—ë—Ç —Å—Ç–∞—Ç—É—Å–æ–≤

**–û—Ç—á—ë—Ç—ã:**
- ‚úì P&L —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- ‚úì Aging —Å bucket'–∞–º–∏ –ø–æ —Å—Ä–æ–∫–∞–º
- ‚úì –°–≤–µ—Ä–∫–∞ —Å–º–µ–Ω

---

## üéÅ –ë–æ–Ω—É—Å—ã

- ‚úÖ –ú—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å
- ‚úÖ RBAC (—Ä–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞)
- ‚úÖ Audit logs
- ‚úÖ iiko –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (—á–µ–∫–∏ + —Å–º–µ–Ω—ã)
- ‚úÖ Google Sheets –∏–º–ø–æ—Ä—Ç
- ‚úÖ –ö—Ä–∞—Å–∏–≤—ã–π UI —Å shadcn/ui
- ‚úÖ –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≤—ë—Ä—Å—Ç–∫–∞

---

## üìä Git –ò—Å—Ç–æ—Ä–∏—è

```
dbf23b8 fix: correct amount formatting in shifts UI
b196e81 docs: update checklist with iiko integration section
b3af1e8 refactor: shifts UI - remove manual entry, add reconciliation
ed5d707 feat: automatic shift import from iiko receipts
4324988 docs: add Finance v3 MVP summary and update checklist
1986ffc feat: complete Finance v3 MVP - payments UI, improved P&L
f490c0d feat: add frontend UI for shifts and expense docs
d56f1cd feat: add reports (Aging, Shift Summary) and seed data
ebce803 feat: add ExpenseDoc and Payment APIs with allocations
120b198 feat: add finance v3 models and API
71d28df feat: initial commit - Piligrim finance system
```

---

## üö¶ Roadmap

### v3.0 (—Ç–µ–∫—É—â–∞—è) - MVP ‚úÖ
- –°–º–µ–Ω—ã –∏–∑ iiko
- –£—á—ë—Ç –¥–æ–ª–≥–æ–≤
- –£–ª—É—á—à–µ–Ω–Ω—ã–π P&L
- –û—Ç—á—ë—Ç Aging

### v3.1 (–±—É–¥—É—â–µ–µ) - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
- Cash Flow –Ω–∞ –±–∞–∑–µ CashTx
- UI —Å–≤–µ—Ä–∫–∏ –±–∞–Ω–∫–∞
- –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–µ—Ä–∏–æ–¥–∞ (lock)
- –ê–≤—Ç–æ–∏–º–ø–æ—Ä—Ç –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é

### v3.2 (–±—É–¥—É—â–µ–µ) - —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- –ê–≥—Ä–µ–≥–∞—Ç–æ—Ä—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- –ë—é–¥–∂–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü—Ä–æ–≥–Ω–æ–∑—ã –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –ï–∂–µ–¥–Ω–µ–≤–Ω–æ:
1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —á–µ–∫–∏ iiko
2. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–º–µ–Ω—ã (–∫–Ω–æ–ø–∫–∞ –≤ UI)
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤–µ—Ä–∫—É

### –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ:
1. –°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã —Ä–∞—Å—Ö–æ–¥–æ–≤ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Å—á–µ—Ç–æ–≤
2. –û–ø–ª–∞—Ç–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ UI –ø–ª–∞—Ç–µ–∂–µ–π

### –ï–∂–µ–º–µ—Å—è—á–Ω–æ:
1. –ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ —Å–º–µ–Ω—ã
2. –û–ø–ª–∞—Ç–∏—Ç—å –≤—Å–µ —Å—á–µ—Ç–∞
3. –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å P&L
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Aging (–Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥–æ–ª–≥–æ–≤ > 60 –¥–Ω–µ–π)
5. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á—ë—Ç—ã

---

## üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- ‚ö° –ò–º–ø–æ—Ä—Ç 251 —á–µ–∫–∞ ‚Üí 3 —Å–º–µ–Ω—ã –∑–∞ **30 —Å–µ–∫—É–Ω–¥**
- ‚ö° –í–º–µ—Å—Ç–æ 5-10 –º–∏–Ω—É—Ç —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ ‚Üí **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**

### –¢–æ—á–Ω–æ—Å—Ç—å:
- üéØ 100% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å iiko —á–µ–∫–∞–º–∏
- üéØ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–≤–µ—Ä–∫–∞ —Å –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π

### –£–¥–æ–±—Å—Ç–≤–æ:
- üé® –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π UI —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π
- üîç –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –∫–ª–∏–∫—É
- üì± –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≤—ë—Ä—Å—Ç–∫–∞

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- `docs/finance-v3-summary.md` - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- `docs/iiko-shifts-integration.md` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- `server/scripts/seed-finance-v3.ts` - seed —Å–∫—Ä–∏–ø—Ç

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- `server/prisma/migrations/20251001120000_add_finance_v3_models/`

---

## üéä –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production!

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏! üöÄ

---

**–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ:** 01.10.2025  
**–ö–æ–º–º–∏—Ç–æ–≤:** 10  
**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** 4,504  
**–§–∞–π–ª–æ–≤:** 27  
**–ó–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ:** 19/20 (95%)

